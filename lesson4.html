<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4.åœ°ç‚¹ä¸äº¤é€š - HSKç»ƒä¹ </title>
    <style>
        :root {
            --primary: #2980b9; /* äº¤é€šè“ */
            --secondary: #3498db;
            --correct: #27ae60;
            --wrong: #c0392b;
            --bg: #ecf0f1;
            --card-bg: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            color: #2c3e50;
        }

        .container {
            width: 100%;
            max-width: 650px;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: 90vh;
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 20px;
            text-align: center;
            flex-shrink: 0;
        }

        h1 { margin: 0; font-size: 1.3rem; letter-spacing: 1px; }
        .stats { margin-top: 8px; font-size: 0.95rem; opacity: 0.9; }

        /* å†…å®¹åŒºåŸŸ */
        .content {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        /* æ¬¢è¿ç•Œé¢ */
        .start-screen {
            text-align: center;
            margin: auto;
        }
        .start-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: left;
            border: 1px solid #dee2e6;
        }
        .btn-start {
            background: var(--correct);
            color: white;
            border: none;
            padding: 16px 45px;
            font-size: 1.2rem;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.4);
            transition: transform 0.2s;
            font-weight: bold;
        }
        .btn-start:active { transform: scale(0.95); }

        /* é¢˜ç›®åŒºåŸŸ */
        .q-badge {
            display: inline-block;
            background: #d6eaf8;
            color: var(--primary);
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.85rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .q-text {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        /* æ‹¼éŸ³æ ‡æ³¨æ ·å¼ */
        ruby { ruby-position: over; }
        rt { font-size: 0.55em; color: #7f8c8d; font-weight: normal; user-select: none; }

        /* é€‰é¡¹æŒ‰é’® */
        .options-grid { display: grid; gap: 12px; }
        
        .option-btn {
            background: white;
            border: 2px solid #eaeded;
            padding: 15px;
            border-radius: 12px;
            text-align: left;
            font-size: 1.05rem;
            cursor: pointer;
            transition: all 0.2s;
            color: #34495e;
            position: relative;
        }

        .option-btn:hover:not(:disabled) { border-color: var(--primary); background: #f4f6f7; }

        .option-btn.correct { background: #e8f8f5; border-color: var(--correct); color: #1e8449; }
        .option-btn.wrong { background: #fdedec; border-color: var(--wrong); color: #c0392b; }
        .option-btn:disabled { cursor: default; }

        /* è§£æåŒºåŸŸ */
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 5px solid #bdc3c7;
            display: none;
            animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .feedback.is-correct { border-left-color: var(--correct); background: #f0fff4; }
        .feedback.is-wrong { border-left-color: var(--wrong); background: #fff5f5; }

        .thai-expl { margin-top: 8px; font-size: 0.95rem; color: #555; }

        /* åº•éƒ¨å¯¼èˆª */
        .nav-buttons {
            margin-top: auto;
            padding-top: 20px;
            display: flex;
            justify-content: space-between;
        }

        .nav-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: opacity 0.2s;
        }
        .nav-btn.prev { background: #dfe6e9; color: #636e72; }
        .nav-btn.next { background: var(--primary); color: white; box-shadow: 0 3px 10px rgba(41, 128, 185, 0.3); }
        .nav-btn:disabled { opacity: 0.5; cursor: not-allowed; box-shadow: none; }

        /* ç»“æœé¡µ */
        .result-score { font-size: 3.5rem; color: var(--primary); margin: 20px 0; font-weight: bold; }

    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>4.åœ°ç‚¹ä¸äº¤é€š</h1>
        <div class="stats">
            <span id="progress">é¢˜ç›®: 0/35</span> | <span id="score">å¾—åˆ†: 0</span>
        </div>
    </header>

    <div class="content">
        <div id="start-screen" class="start-screen">
            <h2>HSK è¯æ±‡ä¸“é¡¹ç»ƒä¹ </h2>
            <div class="start-info">
                <p>ğŸ“ <strong>å†…å®¹ï¼š</strong> åœ°ç‚¹åè¯ã€äº¤é€šå·¥å…·ã€æ–¹ä½è¯ã€åŠ¨è¯</p>
                <p>ğŸ“ <strong>é¢˜é‡ï¼š</strong> 35 é¢˜ (35 à¸‚à¹‰à¸­)</p>
                <p>ğŸ’¯ <strong>æ»¡åˆ†ï¼š</strong> 70 åˆ† (70 à¸„à¸°à¹à¸™à¸™)</p>
                <p>ğŸ’¡ <strong>è§„åˆ™ï¼š</strong> æ¯é¢˜åªæœ‰ä¸€ä¸ªæ­£ç¡®ç­”æ¡ˆ</p>
            </div>
            <button class="btn-start" onclick="app.startQuiz()">å¼€å§‹ç»ƒä¹  (à¹€à¸£à¸´à¹ˆà¸¡)</button>
        </div>

        <div id="quiz-area" style="display: none; height: 100%; flex-direction: column;">
            <div id="question-container" style="flex-grow: 1;"></div>
            
            <div id="feedback-box" class="feedback"></div>

            <div class="nav-buttons">
                <button id="btn-prev" class="nav-btn prev" onclick="app.prevQuestion()" disabled>ä¸Šä¸€é¢˜</button>
                <button id="btn-next" class="nav-btn next" onclick="app.nextQuestion()" disabled>ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <div id="result-screen" class="start-screen" style="display: none;">
            <h2>ç»ƒä¹ å®Œæˆ (à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™)</h2>
            <div class="result-score" id="final-score">0</div>
            <p style="color: #7f8c8d;">æ»¡åˆ† 70 åˆ†</p>
            <button class="btn-start" onclick="location.reload()" style="margin-top: 20px;">å†ç»ƒä¸€æ¬¡ (à¸—à¸³à¸­à¸µà¸à¸„à¸£à¸±à¹‰à¸‡)</button>
        </div>
    </div>
</div>

<script>
// é¢˜ç›®æ•°æ®ï¼šæ¯é¢˜2åˆ†ï¼Œå…±35é¢˜
// å·²ç§»é™¤åŸé¢˜å·ï¼š19, 29, 36, 39, 40
const questionData = [
    // --- Part 1: æ‹¼éŸ³é¢˜ (1-10) ---
    { q: "åŒ»é™¢", options: ["yÄ« yuÃ n", "yÃ­ yuÃ n", "yÄ« yuÃ¡n", "yÃ¬ yuÃ n"], answer: 0, explain: "yÄ« yuÃ n = à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥ (Hospital)", isPinyin: true },
    { q: "å­¦æ ¡", options: ["xuÃ© xiÃ o", "xuÃ© jiÃ o", "xuÄ› xiÃ o", "xuÃ© xiÄo"], answer: 0, explain: "xuÃ© xiÃ o = à¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™ (School)", isPinyin: true },
    { q: "æœºåœº", options: ["jÄ« chÇng", "jÄ« chÃ¡ng", "jÃ¬ chÇng", "qÄ« chÇng"], answer: 0, explain: "jÄ« chÇng = à¸ªà¸™à¸²à¸¡à¸šà¸´à¸™ (Airport)", isPinyin: true },
    { q: "é£æœº", options: ["fÄ“i jÄ«", "fÄ›i jÄ«", "huÄ« jÄ«", "fÄ“i jÃ­"], answer: 0, explain: "fÄ“i jÄ« = à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸šà¸´à¸™ (Airplane)", isPinyin: true },
    { q: "è½¦ç«™", options: ["chÄ“ zhÃ n", "cÄ“ zhÃ n", "chÄ“ zÃ n", "chÄ“ zhÃ ng"], answer: 0, explain: "chÄ“ zhÃ n = à¸ªà¸–à¸²à¸™à¸µà¸£à¸– (Station)", isPinyin: true },
    { q: "å‡ºç§Ÿè½¦", options: ["chÅ« zÅ« chÄ“", "chÅ« zhÅ« chÄ“", "cÅ« zÅ« chÄ“", "chÅ« zÅ« cÄ“"], answer: 0, explain: "chÅ« zÅ« chÄ“ = à¸£à¸–à¹à¸—à¹‡à¸à¸‹à¸µà¹ˆ (Taxi)", isPinyin: true },
    { q: "é¥­é¦†", options: ["fÃ n guÇn", "fÃ ng guÇn", "fÃ n guÄn", "fÃ n guÇng"], answer: 0, explain: "fÃ n guÇn = à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£ (Restaurant)", isPinyin: true },
    { q: "å•†åº—", options: ["shÄng diÃ n", "sÄng diÃ n", "shÄng diÃ¡n", "shÃ¡ng diÃ n"], answer: 0, explain: "shÄng diÃ n = à¸£à¹‰à¸²à¸™à¸„à¹‰à¸² (Shop)", isPinyin: true },
    { q: "åŒ—äº¬", options: ["BÄ›i jÄ«ng", "BÄ›i jÄ«n", "BÃ©i jÄ«ng", "BÄ›i jÇng"], answer: 0, explain: "BÄ›i jÄ«ng = à¸›à¸±à¸à¸à¸´à¹ˆà¸‡ (Beijing)", isPinyin: true },
    { q: "å“ªé‡Œ", options: ["nÇ li", "nÃ  li", "nÇ lÇ", "nÇ lÄ«"], answer: 0, explain: "nÇ li = à¸—à¸µà¹ˆà¹„à¸«à¸™ (Where) *li è¯»è½»å£°", isPinyin: true },

    // --- Part 2: åœ°ç‚¹ä¸æ–¹ä½ (11-19) ---
    { q: "æˆ‘è¦å»____ä¹°è¡£æœã€‚", options: ["<ruby>å•†åº—<rt>shÄngdiÃ n</rt></ruby>", "<ruby>ä¹¦åº—<rt>shÅ«diÃ n</rt></ruby>", "<ruby>é¥­é¦†<rt>fÃ nguÇn</rt></ruby>", "<ruby>åŒ»é™¢<rt>yÄ«yuÃ n</rt></ruby>"], answer: 0, explain: "à¸‹à¸·à¹‰à¸­à¹€à¸ªà¸·à¹‰à¸­à¸œà¹‰à¸²à¸•à¹‰à¸­à¸‡à¹„à¸› 'à¸£à¹‰à¸²à¸™à¸„à¹‰à¸²' (shÄngdiÃ n)", isPinyin: false },
    { q: "è€å¸ˆåœ¨____é‡Œä¸Šè¯¾ã€‚", options: ["<ruby>æ•™å®¤<rt>jiÃ oshÃ¬</rt></ruby>", "<ruby>å®¶é‡Œ<rt>jiÄlÇ</rt></ruby>", "<ruby>å•†åº—<rt>shÄngdiÃ n</rt></ruby>", "<ruby>è½¦ä¸Š<rt>chÄ“shang</rt></ruby>"], answer: 0, explain: "à¸„à¸£à¸¹à¸ªà¸­à¸™à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¹ƒà¸™ 'à¸«à¹‰à¸­à¸‡à¹€à¸£à¸µà¸¢à¸™' (jiÃ oshÃ¬)", isPinyin: false },
    { q: "åŒ»ç”Ÿåœ¨____å·¥ä½œã€‚", options: ["<ruby>åŒ»é™¢<rt>yÄ«yuÃ n</rt></ruby>", "<ruby>å­¦æ ¡<rt>xuÃ©xiÃ o</rt></ruby>", "<ruby>é¥­é¦†<rt>fÃ nguÇn</rt></ruby>", "<ruby>è½¦ç«™<rt>chÄ“zhÃ n</rt></ruby>"], answer: 0, explain: "à¸«à¸¡à¸­à¸—à¸³à¸‡à¸²à¸™à¸—à¸µà¹ˆ 'à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥' (yÄ«yuÃ n)", isPinyin: false },
    { q: "è¯·é—®ï¼Œæ´—æ‰‹é—´åœ¨____ï¼Ÿ", options: ["<ruby>å“ªå„¿<rt>nÇr</rt></ruby>", "<ruby>è¿™å„¿<rt>zhÃ¨r</rt></ruby>", "<ruby>é‚£å„¿<rt>nÃ r</rt></ruby>", "<ruby>ä»€ä¹ˆ<rt>shÃ©nme</rt></ruby>"], answer: 0, explain: "à¸–à¸²à¸¡à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ 'à¸—à¸µà¹ˆà¹„à¸«à¸™' (nÇr)", isPinyin: false },
    { q: "å­¦æ ¡åœ¨é¥­é¦†çš„____ã€‚", options: ["<ruby>æ—è¾¹<rt>pÃ¡ngbiÄn</rt></ruby>", "<ruby>é‡Œè¾¹<rt>lÇbian</rt></ruby>", "<ruby>ä¸Šè¾¹<rt>shÃ ngbian</rt></ruby>", "<ruby>é•¿<rt>chÃ¡ng</rt></ruby>"], answer: 0, explain: "à¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™à¸­à¸¢à¸¹à¹ˆ 'à¸‚à¹‰à¸²à¸‡à¹†' à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£ (pÃ¡ngbiÄn)", isPinyin: false },
    { q: "æ¡Œå­____æœ‰ä¸€æœ¬ä¹¦ã€‚", options: ["<ruby>ä¸Š<rt>shang</rt></ruby>", "<ruby>ä¸­<rt>zhÅng</rt></ruby>", "<ruby>åŒ—<rt>bÄ›i</rt></ruby>", "<ruby>é«˜<rt>gÄo</rt></ruby>"], answer: 0, explain: "à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¸­à¸¢à¸¹à¹ˆ 'à¸šà¸™' à¹‚à¸•à¹Šà¸° (zhuÅzi shang)", isPinyin: false },
    { q: "æˆ‘å®¶____å­¦æ ¡å¾ˆè¿‘ã€‚", options: ["<ruby>ç¦»<rt>lÃ­</rt></ruby>", "<ruby>ä»<rt>cÃ³ng</rt></ruby>", "<ruby>åœ¨<rt>zÃ i</rt></ruby>", "<ruby>å»<rt>qÃ¹</rt></ruby>"], answer: 0, explain: "à¸šà¸­à¸à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡ A à¸«à¹ˆà¸²à¸‡à¸ˆà¸²à¸ B à¹ƒà¸Šà¹‰ 'lÃ­' (ç¦»)", isPinyin: false },
    { q: "ä¸­å›½åœ¨æ³°å›½çš„____ã€‚", options: ["<ruby>åŒ—è¾¹<rt>bÄ›ibian</rt></ruby>", "<ruby>å—è¾¹<rt>nÃ¡nbian</rt></ruby>", "<ruby>ä¸‹è¾¹<rt>xiÃ bian</rt></ruby>", "<ruby>é‡Œè¾¹<rt>lÇbian</rt></ruby>"], answer: 0, explain: "à¸ˆà¸µà¸™à¸­à¸¢à¸¹à¹ˆà¸—à¸²à¸‡ 'à¸—à¸´à¸¨à¹€à¸«à¸™à¸·à¸­' à¸‚à¸­à¸‡à¹„à¸—à¸¢ (bÄ›ibian)", isPinyin: false },
    // åŸç¬¬19é¢˜å·²åˆ é™¤
    { q: "æ¤…å­åœ¨æ¡Œå­çš„____ã€‚", options: ["<ruby>ä¸‹é¢<rt>xiÃ miÃ n</rt></ruby>", "<ruby>ä¸Šé¢<rt>shÃ ngmiÃ n</rt></ruby>", "<ruby>é‡Œé¢<rt>lÇmiÃ n</rt></ruby>", "<ruby>å¤§<rt>dÃ </rt></ruby>"], answer: 0, explain: "à¸šà¸£à¸´à¸šà¸—à¸™à¸µà¹‰à¹€à¸à¹‰à¸²à¸­à¸µà¹‰à¸¡à¸±à¸à¸ˆà¸°à¸ªà¸­à¸”à¸­à¸¢à¸¹à¹ˆ 'à¹ƒà¸•à¹‰' à¸«à¸£à¸·à¸­à¸­à¸¢à¸¹à¹ˆà¸„à¸¹à¹ˆà¸à¸±à¸šà¹‚à¸•à¹Šà¸° à¹à¸•à¹ˆà¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¸­à¸·à¹ˆà¸™à¹€à¸›à¹‡à¸™à¹„à¸›à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸—à¸²à¸‡à¸à¸²à¸¢à¸ à¸²à¸ (à¸šà¸™à¹‚à¸•à¹Šà¸°/à¹ƒà¸™à¹‚à¸•à¹Šà¸°)", isPinyin: false },

    // --- Part 3: äº¤é€šä¸åŠ¨è¯ (20-28) ---
    { q: "æˆ‘æ˜¯____å…¬å…±æ±½è½¦æ¥çš„ã€‚", options: ["<ruby>å<rt>zuÃ²</rt></ruby>", "<ruby>åš<rt>zuÃ²</rt></ruby>", "<ruby>æ‰“<rt>dÇ</rt></ruby>", "<ruby>å¼€<rt>kÄi</rt></ruby>"], answer: 0, explain: "à¹‚à¸”à¸¢à¸ªà¸²à¸£à¸£à¸–à¹€à¸¡à¸¥à¹Œà¹ƒà¸Šà¹‰à¸à¸£à¸´à¸¢à¸² 'à¸™à¸±à¹ˆà¸‡' (zuÃ²)", isPinyin: false },
    { q: "çˆ¸çˆ¸å–œæ¬¢____è½¦å»å·¥ä½œã€‚", options: ["<ruby>å¼€<rt>kÄi</rt></ruby>", "<ruby>å<rt>zuÃ²</rt></ruby>", "<ruby>æ‰“<rt>dÇ</rt></ruby>", "<ruby>è·‘<rt>pÇo</rt></ruby>"], answer: 0, explain: "à¸‚à¸±à¸šà¸£à¸–à¹€à¸­à¸‡à¹ƒà¸Šà¹‰ 'kÄi' (å¼€)", isPinyin: false },
    { q: "æˆ‘ä»¬è¦å»____é£æœºå»åŒ—äº¬ã€‚", options: ["<ruby>å<rt>zuÃ²</rt></ruby>", "<ruby>ç«™<rt>zhÃ n</rt></ruby>", "<ruby>å¼€<rt>kÄi</rt></ruby>", "<ruby>éª‘<rt>qÃ­</rt></ruby>"], answer: 0, explain: "à¹‚à¸”à¸¢à¸ªà¸²à¸£à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸šà¸´à¸™à¹ƒà¸Šà¹‰ 'à¸™à¸±à¹ˆà¸‡' (zuÃ²)", isPinyin: false },
    { q: "æˆ‘ä¸å–œæ¬¢èµ°è·¯ï¼Œæˆ‘å–œæ¬¢____è‡ªè¡Œè½¦ã€‚", options: ["<ruby>éª‘<rt>qÃ­</rt></ruby>", "<ruby>å<rt>zuÃ²</rt></ruby>", "<ruby>å¼€<rt>kÄi</rt></ruby>", "<ruby>æ‰“<rt>dÇ</rt></ruby>"], answer: 0, explain: "à¸‚à¸µà¹ˆà¸ˆà¸±à¸à¸£à¸¢à¸²à¸™ à¹ƒà¸Šà¹‰ 'qÃ­' (à¸‚à¸µà¹ˆ)", isPinyin: false },
    { q: "å¤ªæ™šäº†ï¼Œæˆ‘ä»¬____å‡ºç§Ÿè½¦å›å®¶å§ã€‚", options: ["<ruby>æ‰“<rt>dÇ</rt></ruby>", "<ruby>å¼€<rt>kÄi</rt></ruby>", "<ruby>éª‘<rt>qÃ­</rt></ruby>", "<ruby>åš<rt>zuÃ²</rt></ruby>"], answer: 0, explain: "à¹€à¸£à¸µà¸¢à¸à¸£à¸–à¹à¸—à¹‡à¸à¸‹à¸µà¹ˆà¹ƒà¸Šà¹‰à¸„à¸³à¸§à¹ˆà¸² 'dÇ chÄ“' (æ‰“è½¦)", isPinyin: false },
    { q: "ä»–åœ¨ç«è½¦ç«™____ç«è½¦ã€‚", options: ["<ruby>ç­‰<rt>dÄ›ng</rt></ruby>", "<ruby>å¼€<rt>kÄi</rt></ruby>", "<ruby>å»<rt>qÃ¹</rt></ruby>", "<ruby>åœ¨<rt>zÃ i</rt></ruby>"], answer: 0, explain: "à¸£à¸­à¸£à¸–à¹„à¸Ÿ à¹ƒà¸Šà¹‰ 'dÄ›ng' (à¸£à¸­)", isPinyin: false },
    { q: "ä»è¿™é‡Œåˆ°æœºåœº____å»ï¼Ÿ", options: ["<ruby>æ€ä¹ˆ<rt>zÄ›nme</rt></ruby>", "<ruby>ä»€ä¹ˆ<rt>shÃ©nme</rt></ruby>", "<ruby>å¤šå°‘<rt>duÅshao</rt></ruby>", "<ruby>å“ªå„¿<rt>nÇr</rt></ruby>"], answer: 0, explain: "à¸–à¸²à¸¡à¸§à¸´à¸˜à¸µà¸à¸²à¸£à¹€à¸”à¸´à¸™à¸—à¸²à¸‡à¹ƒà¸Šà¹‰ 'zÄ›nme' (à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£)", isPinyin: false },
    { q: "ä½ ____ä»€ä¹ˆæ—¶å€™å›ä¸­å›½ï¼Ÿ", options: ["<ruby>æƒ³<rt>xiÇng</rt></ruby>", "<ruby>å»<rt>qÃ¹</rt></ruby>", "<ruby>åœ¨<rt>zÃ i</rt></ruby>", "<ruby>ä»<rt>cÃ³ng</rt></ruby>"], answer: 0, explain: "à¸„à¸¸à¸“ 'à¸„à¸´à¸”/à¸§à¸²à¸‡à¹à¸œà¸™' à¸ˆà¸°à¸à¸¥à¸±à¸šà¸ˆà¸µà¸™à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸«à¸£à¹ˆ (xiÇng)", isPinyin: false },
    // åŸç¬¬29é¢˜å·²åˆ é™¤
    { q: "æˆ‘è¦å»ä¸­å›½____ã€‚", options: ["<ruby>æ—…æ¸¸<rt>lÇšyÃ³u</rt></ruby>", "<ruby>è½¦ç«™<rt>chÄ“zhÃ n</rt></ruby>", "<ruby>æœºç¥¨<rt>jÄ«piÃ o</rt></ruby>", "<ruby>è·¯<rt>lÃ¹</rt></ruby>"], answer: 0, explain: "à¹„à¸›à¸›à¸£à¸°à¹€à¸—à¸¨à¸ˆà¸µà¸™à¹€à¸à¸·à¹ˆà¸­ 'à¸—à¹ˆà¸­à¸‡à¹€à¸—à¸µà¹ˆà¸¢à¸§' (lÇšyÃ³u) - à¸„à¸³à¸­à¸·à¹ˆà¸™à¹€à¸›à¹‡à¸™à¸„à¸³à¸™à¸²à¸¡à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹€à¸‚à¹‰à¸²à¸à¸±à¸šà¸£à¸¹à¸›à¸›à¸£à¸°à¹‚à¸¢à¸„", isPinyin: false },

    // --- Part 4: è¯­æ³•ä¸æƒ…æ™¯é€»è¾‘ (29-35) ---
    { q: "æˆ‘____ä¸­å›½æ¥ã€‚", options: ["<ruby>ä»<rt>cÃ³ng</rt></ruby>", "<ruby>ç¦»<rt>lÃ­</rt></ruby>", "<ruby>åœ¨<rt>zÃ i</rt></ruby>", "<ruby>æ¯”<rt>bÇ</rt></ruby>"], answer: 0, explain: "à¸šà¸­à¸à¸ˆà¸¸à¸”à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ 'à¸ˆà¸²à¸' à¸›à¸£à¸°à¹€à¸—à¸¨à¸ˆà¸µà¸™ à¹ƒà¸Šà¹‰ 'cÃ³ng' (ä»)", isPinyin: false },
    { q: "ä»–åœ¨æˆ¿é—´____ç¡è§‰ã€‚", options: ["<ruby>é‡Œ<rt>li</rt></ruby>", "<ruby>ä¸Š<rt>shang</rt></ruby>", "<ruby>ä¸‹<rt>xiÃ </rt></ruby>", "<ruby>å¤–<rt>wÃ i</rt></ruby>"], answer: 0, explain: "à¹ƒà¸™à¸«à¹‰à¸­à¸‡ à¹ƒà¸Šà¹‰ 'fÃ¡ngjiÄn li'", isPinyin: false },
    { q: "A: ä½ å»å“ªå„¿ï¼Ÿ<br>B: æˆ‘____å­¦æ ¡ã€‚", options: ["<ruby>å»<rt>qÃ¹</rt></ruby>", "<ruby>æ¥<rt>lÃ¡i</rt></ruby>", "<ruby>åœ¨<rt>zÃ i</rt></ruby>", "<ruby>ä»<rt>cÃ³ng</rt></ruby>"], answer: 0, explain: "à¸–à¸²à¸¡à¹„à¸›à¹„à¸«à¸™ à¸•à¸­à¸š 'à¹„à¸›' à¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™ (qÃ¹)", isPinyin: false },
    { q: "A: ä½ åœ¨å“ªå„¿ï¼Ÿ<br>B: æˆ‘____å®¶ã€‚", options: ["<ruby>åœ¨<rt>zÃ i</rt></ruby>", "<ruby>å»<rt>qÃ¹</rt></ruby>", "<ruby>æ¥<rt>lÃ¡i</rt></ruby>", "<ruby>å›<rt>huÃ­</rt></ruby>"], answer: 0, explain: "à¸–à¸²à¸¡à¸­à¸¢à¸¹à¹ˆà¸—à¸µà¹ˆà¹„à¸«à¸™ à¸•à¸­à¸š 'à¸­à¸¢à¸¹à¹ˆ' à¸šà¹‰à¸²à¸™ (zÃ i)", isPinyin: false },
    { q: "A: æˆ‘ä»¬å‡ ç‚¹å»åƒé¥­ï¼Ÿ<br>B: ____å»å§ã€‚", options: ["<ruby>ç°åœ¨<rt>xiÃ nzÃ i</rt></ruby>", "<ruby>æ˜¨å¤©<rt>zuÃ³tiÄn</rt></ruby>", "<ruby>å“ªé‡Œ<rt>nÇlÇ</rt></ruby>", "<ruby>è¿™é‡Œ<rt>zhÃ¨lÇ</rt></ruby>"], answer: 0, explain: "à¸Šà¸§à¸™à¹„à¸›à¸à¸´à¸™à¸‚à¹‰à¸²à¸§ 'à¸•à¸­à¸™à¸™à¸µà¹‰' à¹€à¸¥à¸¢à¹€à¸–à¸­à¸° (xiÃ nzÃ i)", isPinyin: false },
    // åŸç¬¬36é¢˜å·²åˆ é™¤
    { q: "æˆ‘å®¶åœ¨å…¬å¸çš„____ã€‚", options: ["<ruby>åé¢<rt>hÃ²umiÃ n</rt></ruby>", "<ruby>ä¸Šé¢<rt>shÃ ngmiÃ n</rt></ruby>", "<ruby>é‡Œé¢<rt>lÇmiÃ n</rt></ruby>", "<ruby>å°<rt>xiÇo</rt></ruby>"], answer: 0, explain: "à¸šà¹‰à¸²à¸™à¸­à¸¢à¸¹à¹ˆ 'à¸”à¹‰à¸²à¸™à¸«à¸¥à¸±à¸‡' à¸šà¸£à¸´à¸©à¸±à¸— (hÃ²umiÃ n) à¹€à¸›à¹‡à¸™à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸—à¸µà¹ˆà¸ªà¸¡à¹€à¸«à¸•à¸¸à¸ªà¸¡à¸œà¸¥à¸—à¸µà¹ˆà¸ªà¸¸à¸”", isPinyin: false },
    { q: "è·¯ä¸Š____å¤šè½¦ã€‚", options: ["<ruby>å¾ˆ<rt>hÄ›n</rt></ruby>", "<ruby>æ˜¯<rt>shÃ¬</rt></ruby>", "<ruby>æœ‰<rt>yÇ’u</rt></ruby>", "<ruby>åœ¨<rt>zÃ i</rt></ruby>"], answer: 0, explain: "à¸šà¸™à¸–à¸™à¸™ 'à¸¡à¸µ' à¸£à¸–à¹€à¸¢à¸­à¸° (yÇ’u hÄ›n duÅ chÄ“)", isPinyin: false }
    // åŸç¬¬39é¢˜å·²åˆ é™¤
    // åŸç¬¬40é¢˜å·²åˆ é™¤
];

// --- åº”ç”¨ç¨‹åºé€»è¾‘ ---
const app = {
    currentIndex: 0,
    score: 0,
    answers: new Array(questionData.length).fill(null), // è®°å½•ç”¨æˆ·ç­”æ¡ˆ
    shuffledQs: [], // å­˜å‚¨å¤„ç†åçš„é¢˜ç›®ï¼ˆé€‰é¡¹å·²æ‰“ä¹±ï¼‰

    // åˆå§‹åŒ–
    startQuiz: function() {
        // 1. æ·±åº¦å¤„ç†é¢˜ç›®æ•°æ®ï¼šä¿æŒé¢˜ç›®é¡ºåºï¼Œä½†æ‰“ä¹±é€‰é¡¹é¡ºåº
        this.shuffledQs = questionData.map((item, index) => {
            // åˆ›å»ºé€‰é¡¹ç´¢å¼•æ•°ç»„ [0, 1, 2, 3]
            let indices = [0, 1, 2, 3];
            // Fisher-Yates æ´—ç‰Œç®—æ³•æ‰“ä¹±ç´¢å¼•
            for (let i = indices.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [indices[i], indices[j]] = [indices[j], indices[i]];
            }
            return {
                ...item,
                originalIndex: index,
                shuffledIndices: indices // ä¿å­˜æ‰“ä¹±åçš„é€‰é¡¹é¡ºåº
            };
        });

        this.currentIndex = 0;
        this.score = 0;
        this.answers.fill(null);

        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'none';
        document.getElementById('quiz-area').style.display = 'flex';
        document.getElementById('score').innerText = 'å¾—åˆ†: 0';
        
        this.renderQuestion();
    },

    // æ¸²æŸ“é¢˜ç›®
    renderQuestion: function() {
        const index = this.currentIndex;
        const q = this.shuffledQs[index];
        const container = document.getElementById('question-container');
        
        // æ›´æ–°è¿›åº¦
        document.getElementById('progress').innerText = `é¢˜ç›®: ${index + 1}/${questionData.length}`;

        // ç¡®å®šé¢˜ç›®ç±»å‹æ ‡ç­¾
        let badgeText = q.isPinyin ? "æ‹¼éŸ³æµ‹è¯• (Pinyin)" : "è¯æ±‡ä¸è¯­æ³• (Vocab & Grammar)";
        
        // æ„å»ºHTML
        let html = `
            <div class="q-badge">${badgeText}</div>
            <div class="q-text">${index + 1}. ${q.q}</div>
            <div class="options-grid">
        `;

        // æ ¹æ®æ‰“ä¹±çš„ç´¢å¼•æ¸²æŸ“é€‰é¡¹
        q.shuffledIndices.forEach(optIndex => {
            const optText = q.options[optIndex];
            const userChoice = this.answers[index];
            
            let btnClass = "option-btn";
            let disabledAttr = "";
            let clickHandler = `onclick="app.handleAnswer(${optIndex})"`;

            // å¦‚æœå·²ä½œç­”ï¼Œæ˜¾ç¤ºçŠ¶æ€
            if (userChoice !== null) {
                disabledAttr = "disabled";
                clickHandler = "";
                if (optIndex === q.answer) {
                    btnClass += " correct"; // æ­£ç¡®ç­”æ¡ˆæ€»æ˜¯ç»¿è‰²
                } else if (userChoice === optIndex) {
                    btnClass += " wrong"; // ç”¨æˆ·é€‰é”™çš„æ˜¾ç¤ºçº¢è‰²
                }
            }

            html += `<button class="${btnClass}" ${disabledAttr} ${clickHandler}>${optText}</button>`;
        });

        html += `</div>`;
        container.innerHTML = html;

        this.updateFeedbackAndNav();
    },

    // å¤„ç†ç”¨æˆ·ç‚¹å‡»
    handleAnswer: function(selectedIndex) {
        if (this.answers[this.currentIndex] !== null) return; // é˜²æ­¢é‡å¤ç‚¹å‡»

        const q = this.shuffledQs[this.currentIndex];
        this.answers[this.currentIndex] = selectedIndex;

        // è®¡åˆ† (æ¯é¢˜2åˆ†)
        if (selectedIndex === q.answer) {
            this.score += 2;
            document.getElementById('score').innerText = `å¾—åˆ†: ${this.score}`;
        }

        // é‡æ–°æ¸²æŸ“ä»¥æ˜¾ç¤ºé¢œè‰²å’Œè§£æ
        this.renderQuestion();
    },

    // æ›´æ–°è§£æåŒºå’Œå¯¼èˆªæŒ‰é’®çŠ¶æ€
    updateFeedbackAndNav: function() {
        const index = this.currentIndex;
        const userChoice = this.answers[index];
        const q = this.shuffledQs[index];
        
        const feedbackBox = document.getElementById('feedback-box');
        const nextBtn = document.getElementById('btn-next');
        const prevBtn = document.getElementById('btn-prev');

        // è§£ææ˜¾ç¤ºé€»è¾‘
        if (userChoice !== null) {
            const isCorrect = (userChoice === q.answer);
            feedbackBox.style.display = 'block';
            feedbackBox.className = `feedback ${isCorrect ? 'is-correct' : 'is-wrong'}`;
            
            // è·å–æ­£ç¡®ç­”æ¡ˆæ–‡æœ¬ï¼ˆå»é™¤HTMLæ ‡ç­¾ç”¨äºæ˜¾ç¤ºçº¯æ–‡æœ¬ï¼‰
            const tempDiv = document.createElement("div");
            tempDiv.innerHTML = q.options[q.answer];
            const correctText = tempDiv.innerText;

            feedbackBox.innerHTML = `
                <strong>${isCorrect ? 'âœ… å›ç­”æ­£ç¡® (à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡)' : 'âŒ å›ç­”é”™è¯¯ (à¸•à¸­à¸šà¸œà¸´à¸”)'}</strong>
                <div style="margin-top: 5px;">æ­£ç¡®ç­”æ¡ˆ: <b>${correctText}</b></div>
                <div class="thai-expl">è§£æ: ${q.explain}</div>
            `;
            nextBtn.disabled = false;
        } else {
            feedbackBox.style.display = 'none';
            nextBtn.disabled = true;
        }

        // æŒ‰é’®çŠ¶æ€
        prevBtn.disabled = (index === 0);
        
        if (index === questionData.length - 1) {
            nextBtn.innerText = "æŸ¥çœ‹æˆç»© (à¸”à¸¹à¸„à¸°à¹à¸™à¸™)";
        } else {
            nextBtn.innerText = "ä¸‹ä¸€é¢˜ (à¸‚à¹‰à¸­à¸–à¸±à¸”à¹„à¸›)";
        }
    },

    // ä¸‹ä¸€é¢˜
    nextQuestion: function() {
        if (this.currentIndex < questionData.length - 1) {
            this.currentIndex++;
            this.renderQuestion();
        } else {
            this.showResult();
        }
    },

    // ä¸Šä¸€é¢˜
    prevQuestion: function() {
        if (this.currentIndex > 0) {
            this.currentIndex--;
            this.renderQuestion();
        }
    },

    // æ˜¾ç¤ºç»“æœ
    showResult: function() {
        document.getElementById('quiz-area').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
        document.getElementById('final-score').innerText = this.score;
    }
};

</script>

</body>
</html>
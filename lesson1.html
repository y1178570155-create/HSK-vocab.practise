<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSK 3çº§ - 1.äººç‰©ä¸ç¤¾ä¼šèº«ä»½</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: "Sarabun", "Helvetica Neue", Helvetica, Arial, sans-serif; background-color: #f4f7f6; margin: 0; padding: 0; display: flex; justify-content: center; min-height: 100vh; }
        .container { width: 100%; max-width: 600px; background: white; box-shadow: 0 4px 15px rgba(0,0,0,0.1); min-height: 100vh; display: flex; flex-direction: column; }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        .top-bar { background-color: #4a90e2; color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .score-badge { background: white; color: #4a90e2; padding: 5px 12px; border-radius: 20px; font-weight: bold; font-size: 16px; }
        .q-counter { font-size: 14px; opacity: 0.9; }

        /* æ¬¢è¿å±å¹• */
        #start-screen { padding: 40px 20px; text-align: center; display: flex; flex-direction: column; justify-content: center; height: 80vh; }
        h1 { color: #333; margin-bottom: 10px; }
        .subtitle { color: #666; margin-bottom: 40px; }
        .start-btn { background: #4a90e2; color: white; font-size: 20px; padding: 15px 40px; border: none; border-radius: 50px; cursor: pointer; transition: transform 0.2s; box-shadow: 0 4px 10px rgba(74, 144, 226, 0.4); }
        .start-btn:active { transform: scale(0.95); }

        /* é¢˜ç›®åŒºåŸŸ */
        #quiz-screen { display: none; padding: 20px; padding-bottom: 80px; }
        .question-card { margin-bottom: 20px; }
        .q-type { font-size: 12px; color: #888; background: #eee; padding: 2px 8px; border-radius: 4px; display: inline-block; margin-bottom: 10px; }
        .q-text { font-size: 20px; font-weight: bold; color: #2c3e50; line-height: 1.6; margin-bottom: 5px; }
        .q-pinyin { font-size: 16px; color: #7f8c8d; margin-bottom: 20px; font-style: italic; }
        
        /* é€‰é¡¹ */
        .options-grid { display: flex; flex-direction: column; gap: 12px; }
        .option-btn { background: #fff; border: 2px solid #e0e0e0; padding: 15px; border-radius: 10px; text-align: left; font-size: 17px; cursor: pointer; transition: all 0.2s; position: relative; color: #333; }
        .option-btn:hover { background-color: #f8f9fa; border-color: #bdc3c7; }
        
        /* çŠ¶æ€é¢œè‰² */
        .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
        .option-btn.wrong { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
        .option-btn.disabled { pointer-events: none; opacity: 0.9; }
        
        /* è§£æåŒºåŸŸ */
        .feedback-box { margin-top: 20px; padding: 15px; border-radius: 8px; background: #e8f4fd; border-left: 5px solid #4a90e2; display: none; }
        .thai-expl { margin-top: 8px; color: #555; font-size: 15px; }

        /* åº•éƒ¨å¯¼èˆªæŒ‰é’® */
        .footer-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; padding: 15px; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); display: flex; justify-content: center; gap: 15px; max-width: 600px; margin: 0 auto; display: none; }
        .nav-btn { padding: 12px 25px; border-radius: 8px; border: none; font-size: 16px; font-weight: bold; cursor: pointer; flex: 1; }
        .btn-prev { background: #ecf0f1; color: #7f8c8d; }
        .btn-next { background: #4a90e2; color: white; display: none; }

        /* ç»“æœé¡µ */
        #result-screen { display: none; text-align: center; padding: 40px 20px; }
        .final-score { font-size: 60px; font-weight: bold; color: #4a90e2; margin: 20px 0; }
    </style>
</head>
<body>

<div class="container">
    
    <div id="start-screen">
        <h1>1. äººç‰©ä¸ç¤¾ä¼šèº«ä»½</h1>
        <div class="subtitle">HSK 3çº§ è¯æ±‡ç»ƒä¹  (ç”±ç®€å…¥éš¾)</div>
        <div style="background:#eef2f7; padding:20px; border-radius:10px; margin-bottom:30px; text-align:left;">
            <p>ğŸ“Š é¢˜ç›®æ•°é‡ï¼š<strong>40 é¢˜</strong></p>
            <p>ğŸ’¯ æ»¡åˆ†ï¼š<strong>40 åˆ†</strong></p>
            <p>ğŸ“ˆ éš¾åº¦ï¼š<strong>æ‹¼éŸ³åŸºç¡€ â†’ è¯­å¢ƒç†è§£</strong></p>
        </div>
        <button class="start-btn" onclick="startQuiz()">å¼€å§‹ç»ƒä¹  (Start)</button>
    </div>

    <div id="quiz-screen">
        <div class="top-bar">
            <span class="q-counter" id="q-progress">1 / 40</span>
            <div class="score-badge">å¾—åˆ†: <span id="current-score">0</span></div>
        </div>

        <div class="question-card">
            <span class="q-type" id="q-type-label">è¯æ±‡ç†è§£</span>
            <div class="q-text" id="q-text">é¢˜ç›®åŠ è½½ä¸­...</div>
            <div class="q-pinyin" id="q-pinyin"></div>
        </div>

        <div class="options-grid" id="options-container">
            </div>

        <div class="feedback-box" id="feedback-box">
            <div id="feedback-content"></div>
        </div>
    </div>

    <div class="footer-nav" id="footer-nav">
        <button class="nav-btn btn-prev" id="btn-prev" onclick="prevQuestion()">ä¸Šä¸€é¢˜ (Prev)</button>
        <button class="nav-btn btn-next" id="btn-next" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ (Next)</button>
    </div>

    <div id="result-screen">
        <h2>ç»ƒä¹ å®Œæˆ! (Completed)</h2>
        <p>ä½ çš„æœ€ç»ˆå¾—åˆ†</p>
        <div class="final-score" id="final-score-display">0</div>
        <p style="color:#666;">è¯·æˆªå›¾å‘é€ç»™è€å¸ˆ</p>
        <button class="start-btn" onclick="location.reload()" style="margin-top:20px;">å†åšä¸€æ¬¡ (Retry)</button>
    </div>

</div>

<script>
/**
 * é¢˜ç›®æ•°æ® - æŒ‰éš¾åº¦æ’åº
 * Part 1: Type 2 (çœ‹å­—é€‰æ‹¼éŸ³) - åŸºç¡€
 * Part 2: Type 1 (è¯­å¢ƒé€‰è¯ï¼Œå¸¦æ‹¼éŸ³) - è¿›é˜¶
 */
const rawQuestions = [
    // ============================================
    // PART 1: æ‹¼éŸ³è¾¨è¯† (Simple Recognition)
    // ============================================
    { q: "è¯·é€‰æ‹©â€œçˆ·çˆ·â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["yÃ©ye", "yÄ›ye", "bÃ ba", "yÃ¨ye"], ans: "yÃ©ye", t: "çˆ·çˆ· (yÃ©ye) à¸„à¸¸à¸“à¸›à¸¹à¹ˆ (æ³¨æ„: ç¬¬äºŒä¸ªå­—è½»å£°)" },

    { q: "è¯·é€‰æ‹©â€œå¥¶å¥¶â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["nÇinai", "nÄinai", "mÄma", "nÃ inai"], ans: "nÇinai", t: "å¥¶å¥¶ (nÇinai) à¸„à¸¸à¸“à¸¢à¹ˆà¸²" },

    { q: "è¯·é€‰æ‹©â€œé˜¿å§¨â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["ÄyÃ­", "ÄyÃ¬", "Ã¡yÃ­", "Ã yÃ­"], ans: "ÄyÃ­", t: "é˜¿å§¨ (ÄyÃ­) à¸„à¸¸à¸“à¸™à¹‰à¸²/à¸›à¹‰à¸²" },

    { q: "è¯·é€‰æ‹©â€œå”å”â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["shÅ«shu", "sÅ«shu", "shÃºshu", "jiÃ¹jiu"], ans: "shÅ«shu", t: "å”å” (shÅ«shu) à¸„à¸¸à¸“à¸­à¸²à¸œà¸¹à¹‰à¸Šà¸²à¸¢" },

    { q: "è¯·é€‰æ‹©â€œç»ç†â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["jÄ«nglÇ", "jÄ«nglÃ¬", "jÃ¬nglÇ", "jÄ«nlÇ"], ans: "jÄ«nglÇ", t: "ç»ç† (jÄ«nglÇ) à¸œà¸¹à¹‰à¸ˆà¸±à¸”à¸à¸²à¸£" },

    { q: "è¯·é€‰æ‹©â€œå¸æœºâ€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["sÄ«jÄ«", "shÄ«jÄ«", "sÃ¬jÄ«", "sÄ«jÃ¬"], ans: "sÄ«jÄ«", t: "å¸æœº (sÄ«jÄ«) à¸„à¸™à¸‚à¸±à¸šà¸£à¸–" },

    { q: "è¯·é€‰æ‹©â€œæ ¡é•¿â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["xiÃ ozhÇng", "xiÃ ochÃ¡ng", "xiÇozhÇng", "xiÃ ozhang"], ans: "xiÃ ozhÇng", t: "æ ¡é•¿ (xiÃ ozhÇng) à¸„à¸£à¸¹à¹ƒà¸«à¸à¹ˆ (æ³¨æ„: é•¿è¯» zhÇng)" },

    { q: "è¯·é€‰æ‹©â€œåŒäº‹â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["tÃ³ngshÃ¬", "tÃ³ngxuÃ©", "tÃ²ngshÃ¬", "tÃ³ngshÃ­"], ans: "tÃ³ngshÃ¬", t: "åŒäº‹ (tÃ³ngshÃ¬) à¹€à¸à¸·à¹ˆà¸­à¸™à¸£à¹ˆà¸§à¸¡à¸‡à¸²à¸™" },

    { q: "è¯·é€‰æ‹©â€œé‚»å±…â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["lÃ­njÅ«", "lÃ­ngjÅ«", "lÃ­njÃº", "lÃ­ngjÃº"], ans: "lÃ­njÅ«", t: "é‚»å±… (lÃ­njÅ«) à¹€à¸à¸·à¹ˆà¸­à¸™à¸šà¹‰à¸²à¸™ (æ³¨æ„: lÃ­n æ˜¯å‰é¼»éŸ³)" },

    { q: "è¯·é€‰æ‹©â€œå®¢äººâ€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["kÃ¨rÃ©n", "kÄ“rÃ©n", "kÃ¨rÄ›n", "gÃ¨rÃ©n"], ans: "kÃ¨rÃ©n", t: "å®¢äºº (kÃ¨rÃ©n) à¹à¸‚à¸" },

    { q: "è¯·é€‰æ‹©â€œè‡ªå·±â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["zÃ¬jÇ", "zhÃ¬jÇ", "zÃ¬jÄ«", "zÃ¬jÃ­"], ans: "zÃ¬jÇ", t: "è‡ªå·± (zÃ¬jÇ) à¸•à¸™à¹€à¸­à¸‡" },

    { q: "è¯·é€‰æ‹©â€œèº«ä½“â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["shÄ“ntÇ", "shÄ“ntÄ«", "shÃ©ntÇ", "sÄ“ntÇ"], ans: "shÄ“ntÇ", t: "èº«ä½“ (shÄ“ntÇ) à¸£à¹ˆà¸²à¸‡à¸à¸²à¸¢" },

    { q: "è¯·é€‰æ‹©â€œåå­—â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["mÃ­ngzi", "mÃ­ngzÃ¬", "mÃ­nzi", "mÃ¬ngzi"], ans: "mÃ­ngzi", t: "åå­— (mÃ­ngzi) à¸Šà¸·à¹ˆà¸­" },

    { q: "è¯·é€‰æ‹©â€œæœåŠ¡å‘˜â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["fÃºwÃ¹yuÃ¡n", "fÅ«wÃ¹yuÃ¡n", "fÃºwÃ¹yuÇn", "fÃºwÃ¹yÃºan"], ans: "fÃºwÃ¹yuÃ¡n", t: "æœåŠ¡å‘˜ (fÃºwÃ¹yuÃ¡n) à¸à¸™à¸±à¸à¸‡à¸²à¸™à¸šà¸£à¸´à¸à¸²à¸£" },

    { q: "è¯·é€‰æ‹©â€œæ„¿æ„â€çš„æ‹¼éŸ³ï¼š", p: "", type: 2,
      opts: ["yuÃ nyÃ¬", "yuÃ¡nyÃ¬", "yuÃ nyi", "yuÃ¡nyi"], ans: "yuÃ nyÃ¬", t: "æ„¿æ„ (yuÃ nyÃ¬) à¸ªà¸¡à¸±à¸„à¸£à¹ƒà¸ˆ/à¸¢à¸­à¸¡" },

    // ============================================
    // PART 2: è¯­å¢ƒä¸é€»è¾‘ (Meaning & Context)
    // ============================================
    { q: "çˆ¸çˆ¸çš„çˆ¸çˆ¸ï¼Œä½ åº”è¯¥å«ä»–ä»€ä¹ˆï¼Ÿ", p: "BÃ ba de bÃ ba, nÇ yÄ«nggÄi jiÃ o tÄ shÃ©nme?", type: 1, 
      opts: ["çˆ·çˆ· (yÃ©ye)", "å¥¶å¥¶ (nÇinai)", "å”å” (shÅ«shu)", "é˜¿å§¨ (ÄyÃ­)"], ans: "çˆ·çˆ· (yÃ©ye)", t: "à¸à¹ˆà¸­à¸‚à¸­à¸‡à¸à¹ˆà¸­ à¹€à¸£à¸µà¸¢à¸à¸§à¹ˆà¸² 'çˆ·çˆ·' (à¸›à¸¹à¹ˆ)" },

    { q: "å¦ˆå¦ˆçš„å§å¦¹ï¼Œæˆ‘åº”è¯¥å«å¥¹______ã€‚", p: "MÄma de jiÄ›mÃ¨i, wÇ’ yÄ«nggÄi jiÃ o tÄ ______.", type: 1,
      opts: ["é˜¿å§¨ (ÄyÃ­)", "å¥¶å¥¶ (nÇinai)", "çˆ·çˆ· (yÃ©ye)", "å”å” (shÅ«shu)"], ans: "é˜¿å§¨ (ÄyÃ­)", t: "à¸à¸µà¹ˆà¸ªà¸²à¸§à¸«à¸£à¸·à¸­à¸™à¹‰à¸­à¸‡à¸ªà¸²à¸§à¸‚à¸­à¸‡à¹à¸¡à¹ˆ à¹€à¸£à¸µà¸¢à¸à¸§à¹ˆà¸² 'é˜¿å§¨' (à¸™à¹‰à¸²/à¸›à¹‰à¸²)" },

    { q: "çˆ¸çˆ¸çš„å¼Ÿå¼Ÿå«______ã€‚", p: "BÃ ba de dÃ¬di jiÃ o ______.", type: 1,
      opts: ["å”å” (shÅ«shu)", "èˆ…èˆ… (jiÃ¹jiu)", "çˆ·çˆ· (yÃ©ye)", "å“¥å“¥ (gÄ“ge)"], ans: "å”å” (shÅ«shu)", t: "à¸™à¹‰à¸­à¸‡à¸Šà¸²à¸¢à¸‚à¸­à¸‡à¸à¹ˆà¸­ à¹€à¸£à¸µà¸¢à¸à¸§à¹ˆà¸² 'å”å”' (à¸­à¸²à¸œà¸¹à¹‰à¸Šà¸²à¸¢)" },

    { q: "æˆ‘æ˜¯ç”·å­©ï¼Œå¼Ÿå¼Ÿæ¯”æˆ‘å°ï¼Œæˆ‘æ˜¯å¼Ÿå¼Ÿçš„______ã€‚", p: "WÇ’ shÃ¬ nÃ¡nhÃ¡i, dÃ¬di bÇ wÇ’ xiÇo, wÇ’ shÃ¬ dÃ¬di de ______.", type: 1,
      opts: ["å“¥å“¥ (gÄ“ge)", "å§å§ (jiÄ›jie)", "å¼Ÿå¼Ÿ (dÃ¬di)", "å¦¹å¦¹ (mÃ¨imei)"], ans: "å“¥å“¥ (gÄ“ge)", t: "à¸‰à¸±à¸™à¹€à¸›à¹‡à¸™à¸œà¸¹à¹‰à¸Šà¸²à¸¢à¹à¸¥à¸°à¹‚à¸•à¸à¸§à¹ˆà¸²à¸™à¹‰à¸­à¸‡à¸Šà¸²à¸¢ à¸‰à¸±à¸™à¸„à¸·à¸­ 'å“¥å“¥' (à¸à¸µà¹ˆà¸Šà¸²à¸¢)" },

    { q: "å„¿å­å’Œ______éƒ½åœ¨ä¸Šå°å­¦ã€‚", p: "Ã‰rzi hÃ© ______ dÅu zÃ i shÃ ng xiÇoxuÃ©.", type: 1,
      opts: ["å¥³å„¿ (nÇš'Ã©r)", "çˆ¸çˆ¸ (bÃ ba)", "å¦ˆå¦ˆ (mÄma)", "çˆ·çˆ· (yÃ©ye)"], ans: "å¥³å„¿ (nÇš'Ã©r)", t: "à¸„à¸¹à¹ˆà¸à¸±à¸šà¸¥à¸¹à¸à¸Šà¸²à¸¢ (å„¿å­) à¸„à¸·à¸­ 'å¥³å„¿' (à¸¥à¸¹à¸à¸ªà¸²à¸§)" },

    { q: "å¥¹æ˜¯æˆ‘çš„______ï¼Œæˆ‘ä»¬ç»“å©šåå¹´äº†ã€‚", p: "TÄ shÃ¬ wÇ’ de ______, wÇ’men jiÃ©hÅ«n shÃ­ niÃ¡n le.", type: 1,
      opts: ["å¦»å­ (qÄ«zi)", "åŒå­¦ (tÃ³ngxuÃ©)", "å¥³å„¿ (nÇš'Ã©r)", "å§å§ (jiÄ›jie)"], ans: "å¦»å­ (qÄ«zi)", t: "à¸œà¸¹à¹‰à¸«à¸à¸´à¸‡à¸—à¸µà¹ˆà¹à¸•à¹ˆà¸‡à¸‡à¸²à¸™à¸”à¹‰à¸§à¸¢à¸„à¸·à¸­ 'å¦»å­' (à¸ à¸£à¸£à¸¢à¸²)" },

    { q: "æˆ‘æ˜¯ä»–çš„å¦»å­ï¼Œä»–æ˜¯æˆ‘çš„______ã€‚", p: "WÇ’ shÃ¬ tÄ de qÄ«zi, tÄ shÃ¬ wÇ’ de ______.", type: 1,
      opts: ["ä¸ˆå¤« (zhÃ ngfu)", "å“¥å“¥ (gÄ“ge)", "å¼Ÿå¼Ÿ (dÃ¬di)", "æœ‹å‹ (pÃ©ngyou)"], ans: "ä¸ˆå¤« (zhÃ ngfu)", t: "à¸„à¸¹à¹ˆà¸à¸±à¸šà¸ à¸£à¸£à¸¢à¸²à¸„à¸·à¸­ 'ä¸ˆå¤«' (à¸ªà¸²à¸¡à¸µ)" },

    { q: "çˆ¸çˆ¸çš„å¦ˆå¦ˆå«______ã€‚", p: "BÃ ba de mÄma jiÃ o ______.", type: 1,
      opts: ["å¥¶å¥¶ (nÇinai)", "é˜¿å§¨ (ÄyÃ­)", "å¦ˆå¦ˆ (mÄma)", "å§å§ (jiÄ›jie)"], ans: "å¥¶å¥¶ (nÇinai)", t: "à¹à¸¡à¹ˆà¸‚à¸­à¸‡à¸à¹ˆà¸­à¸„à¸·à¸­ 'å¥¶å¥¶' (à¸¢à¹ˆà¸²)" },

    { q: "æˆ‘ä»¬æ˜¯ä¸€å®¶äººï¼Œæˆ‘æœ‰ä¸¤ä¸ª______ã€‚", p: "WÇ’men shÃ¬ yÃ¬jiÄrÃ©n, wÇ’ yÇ’u liÇng gÃ¨ ______.", type: 1,
      opts: ["å­©å­ (hÃ¡izi)", "æœåŠ¡å‘˜ (fÃºwÃ¹yuÃ¡n)", "é‚»å±… (lÃ­njÅ«)", "ç»ç† (jÄ«nglÇ)"], ans: "å­©å­ (hÃ¡izi)", t: "åœ¨å®¶åº­é‡Œæœ‰ 'å­©å­' (à¸¥à¸¹à¸/à¹€à¸”à¹‡à¸)" },

    { q: "åœ¨é¥­åº—é‡Œï¼Œç»™æˆ‘ä»¬ä¸Šèœçš„äººæ˜¯______ã€‚", p: "ZÃ i fÃ ndiÃ n lÇ, gÄ›i wÇ’men shÃ ngcÃ i de rÃ©n shÃ¬ ______.", type: 1,
      opts: ["æœåŠ¡å‘˜ (fÃºwÃ¹yuÃ¡n)", "åŒ»ç”Ÿ (yÄ«shÄ“ng)", "è€å¸ˆ (lÇoshÄ«)", "ç»ç† (jÄ«nglÇ)"], ans: "æœåŠ¡å‘˜ (fÃºwÃ¹yuÃ¡n)", t: "à¸à¸™à¸±à¸à¸‡à¸²à¸™à¹€à¸ªà¸´à¸£à¹Œà¸Ÿà¸„à¸·à¸­ 'æœåŠ¡å‘˜' (à¸à¸™à¸±à¸à¸‡à¸²à¸™à¸šà¸£à¸´à¸à¸²à¸£)" },

    { q: "è°åœ¨å­¦æ ¡å·¥ä½œï¼Ÿ", p: "ShÃ©i zÃ i xuÃ©xiÃ o gÅngzuÃ²?", type: 1,
      opts: ["æ ¡é•¿ (xiÃ ozhÇng)", "å¸æœº (sÄ«jÄ«)", "åŒ»ç”Ÿ (yÄ«shÄ“ng)", "æœåŠ¡å‘˜ (fÃºwÃ¹yuÃ¡n)"], ans: "æ ¡é•¿ (xiÃ ozhÇng)", t: "à¸„à¸™à¸—à¸µà¹ˆà¸—à¸³à¸‡à¸²à¸™à¸—à¸µà¹ˆà¹‚à¸£à¸‡à¹€à¸£à¸µà¸¢à¸™à¸„à¸·à¸­ 'æ ¡é•¿' (à¸„à¸£à¸¹à¹ƒà¸«à¸à¹ˆ)" },

    { q: "æˆ‘ç”Ÿç—…äº†ï¼Œè¦å»åŒ»é™¢çœ‹______ã€‚", p: "WÇ’ shÄ“ngbÃ¬ng le, yÃ o qÃ¹ yÄ«yuÃ n kÃ n ______.", type: 1,
      opts: ["åŒ»ç”Ÿ (yÄ«shÄ“ng)", "è€å¸ˆ (lÇoshÄ«)", "å¸æœº (sÄ«jÄ«)", "ç»ç† (jÄ«nglÇ)"], ans: "åŒ»ç”Ÿ (yÄ«shÄ“ng)", t: "à¸›à¹ˆà¸§à¸¢à¸•à¹‰à¸­à¸‡à¹„à¸›à¸«à¸² 'åŒ»ç”Ÿ' (à¸«à¸¡à¸­)" },

    { q: "å¼€å‡ºç§Ÿè½¦æˆ–è€…å…¬å…±æ±½è½¦çš„äººæ˜¯______ã€‚", p: "KÄi chÅ«zÅ«chÄ“ huÃ²zhÄ› gÅnggÃ²ngqÃ¬chÄ“ de rÃ©n shÃ¬ ______.", type: 1,
      opts: ["å¸æœº (sÄ«jÄ«)", "ç»ç† (jÄ«nglÇ)", "æœåŠ¡å‘˜ (fÃºwÃ¹yuÃ¡n)", "ä¹˜å®¢ (chÃ©ngkÃ¨)"], ans: "å¸æœº (sÄ«jÄ«)", t: "à¸„à¸™à¸‚à¸±à¸šà¸£à¸–à¸„à¸·à¸­ 'å¸æœº' (à¸„à¸™à¸‚à¸±à¸šà¸£à¸–)" },

    { q: "ç‹______æ˜¯è¿™å®¶å…¬å¸çš„è´Ÿè´£äººã€‚", p: "WÃ¡ng ______ shÃ¬ zhÃ¨ jiÄ gÅngsÄ« de fÃ¹zÃ©rÃ©n.", type: 1,
      opts: ["ç»ç† (jÄ«nglÇ)", "å­©å­ (hÃ¡izi)", "åŒå­¦ (tÃ³ngxuÃ©)", "åŒ»ç”Ÿ (yÄ«shÄ“ng)"], ans: "ç»ç† (jÄ«nglÇ)", t: "à¸œà¸¹à¹‰à¸£à¸±à¸šà¸œà¸´à¸”à¸Šà¸­à¸šà¸šà¸£à¸´à¸©à¸±à¸—à¸„à¸·à¸­ 'ç»ç†' (à¸œà¸¹à¹‰à¸ˆà¸±à¸”à¸à¸²à¸£)" },

    { q: "______æ˜¯æ•™å­¦ç”Ÿå­¦ä¹ çš„äººã€‚", p: "______ shÃ¬ jiÄo xuÃ©sheng xuÃ©xÃ­ de rÃ©n.", type: 1,
      opts: ["è€å¸ˆ (lÇoshÄ«)", "å­¦ç”Ÿ (xuÃ©sheng)", "åŒ»ç”Ÿ (yÄ«shÄ“ng)", "æœåŠ¡å‘˜ (fÃºwÃ¹yuÃ¡n)"], ans: "è€å¸ˆ (lÇoshÄ«)", t: "à¸„à¸™à¸ªà¸­à¸™à¸™à¸±à¸à¹€à¸£à¸µà¸¢à¸™à¸„à¸·à¸­ 'è€å¸ˆ' (à¸„à¸¸à¸“à¸„à¸£à¸¹)" },

    { q: "å¯¹å¹´è½»æœªå©šå¥³æ€§çš„å°Šç§°æ˜¯______ã€‚", p: "DuÃ¬ niÃ¡nqÄ«ng wÃ¨ihÅ«n nÇšxÃ¬ng de zÅ«nchÄ“ng shÃ¬ ______.", type: 1,
      opts: ["å°å§ (xiÇojiÄ›)", "å…ˆç”Ÿ (xiÄnsheng)", "é˜¿å§¨ (ÄyÃ­)", "å¥¶å¥¶ (nÇinai)"], ans: "å°å§ (xiÇojiÄ›)", t: "à¸„à¸³à¹€à¸£à¸µà¸¢à¸à¸«à¸à¸´à¸‡à¸ªà¸²à¸§à¸„à¸·à¸­ 'å°å§' (à¸„à¸¸à¸“à¸œà¸¹à¹‰à¸«à¸à¸´à¸‡/à¸™à¸²à¸‡à¸ªà¸²à¸§)" },

    { q: "å¯¹ç”·å£«çš„å°Šç§°æ˜¯______ã€‚", p: "DuÃ¬ nÃ¡nshÃ¬ de zÅ«nchÄ“ng shÃ¬ ______.", type: 1,
      opts: ["å…ˆç”Ÿ (xiÄnsheng)", "å°å§ (xiÇojiÄ›)", "é˜¿å§¨ (ÄyÃ­)", "å­©å­ (hÃ¡izi)"], ans: "å…ˆç”Ÿ (xiÄnsheng)", t: "à¸„à¸³à¹€à¸£à¸µà¸¢à¸à¸œà¸¹à¹‰à¸Šà¸²à¸¢à¸­à¸¢à¹ˆà¸²à¸‡à¸ªà¸¸à¸ à¸²à¸à¸„à¸·à¸­ 'å…ˆç”Ÿ' (à¸„à¸¸à¸“à¸œà¸¹à¹‰à¸Šà¸²à¸¢)" },

    { q: "æˆ‘ä»¬åœ¨åŒä¸€ä¸ªå…¬å¸å·¥ä½œï¼Œä»–æ˜¯æˆ‘çš„______ã€‚", p: "WÇ’men zÃ i tÃ³ng yÃ­ gÃ¨ gÅngsÄ« gÅngzuÃ², tÄ shÃ¬ wÇ’ de ______.", type: 1,
      opts: ["åŒäº‹ (tÃ³ngshÃ¬)", "åŒå­¦ (tÃ³ngxuÃ©)", "é‚»å±… (lÃ­njÅ«)", "å®¢äºº (kÃ¨rÃ©n)"], ans: "åŒäº‹ (tÃ³ngshÃ¬)", t: "à¸„à¸™à¸—à¸µà¹ˆà¸—à¸³à¸‡à¸²à¸™à¸”à¹‰à¸§à¸¢à¸à¸±à¸™à¸„à¸·à¸­ 'åŒäº‹' (à¹€à¸à¸·à¹ˆà¸­à¸™à¸£à¹ˆà¸§à¸¡à¸‡à¸²à¸™)" },

    { q: "ä»–å’Œæˆ‘åœ¨åŒä¸€ä¸ªç­å­¦ä¹ ï¼Œä»–æ˜¯æˆ‘çš„______ã€‚", p: "TÄ hÃ© wÇ’ zÃ i tÃ³ng yÃ­ gÃ¨ bÄn xuÃ©xÃ­, tÄ shÃ¬ wÇ’ de ______.", type: 1,
      opts: ["åŒå­¦ (tÃ³ngxuÃ©)", "åŒäº‹ (tÃ³ngshÃ¬)", "è€å¸ˆ (lÇoshÄ«)", "é‚»å±… (lÃ­njÅ«)"], ans: "åŒå­¦ (tÃ³ngxuÃ©)", t: "à¸„à¸™à¸—à¸µà¹ˆà¹€à¸£à¸µà¸¢à¸™à¸”à¹‰à¸§à¸¢à¸à¸±à¸™à¸„à¸·à¸­ 'åŒå­¦' (à¹€à¸à¸·à¹ˆà¸­à¸™à¸£à¹ˆà¸§à¸¡à¸Šà¸±à¹‰à¸™)" },

    { q: "ä»–ä½åœ¨æˆ‘çš„æ—è¾¹ï¼Œæˆ‘ä»¬æ˜¯______ã€‚", p: "TÄ zhÃ¹ zÃ i wÇ’ de pÃ¡ngbiÄn, wÇ’men shÃ¬ ______.", type: 1,
      opts: ["é‚»å±… (lÃ­njÅ«)", "ç»ç† (jÄ«nglÇ)", "å¸æœº (sÄ«jÄ«)", "æ ¡é•¿ (xiÃ ozhÇng)"], ans: "é‚»å±… (lÃ­njÅ«)", t: "à¸„à¸™à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸‚à¹‰à¸²à¸‡à¸šà¹‰à¸²à¸™à¸„à¸·à¸­ 'é‚»å±…' (à¹€à¸à¸·à¹ˆà¸­à¸™à¸šà¹‰à¸²à¸™)" },

    { q: "ä»Šå¤©å®¶é‡Œæ¥äº†å¾ˆå¤š______ï¼Œæˆ‘è¦æ‹›å¾…ä»–ä»¬ã€‚", p: "JÄ«ntiÄn jiÄlÇ lÃ¡i le hÄ›n duÅ ______, wÇ’ yÃ o zhÄodÃ i tÄmen.", type: 1,
      opts: ["å®¢äºº (kÃ¨rÃ©n)", "è‡ªå·± (zÃ¬jÇ)", "é‚»å±… (lÃ­njÅ«)", "è·¯äºº (lÃ¹rÃ©n)"], ans: "å®¢äºº (kÃ¨rÃ©n)", t: "à¸„à¸™à¸—à¸µà¹ˆà¸¡à¸²à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸šà¹‰à¸²à¸™à¸„à¸·à¸­ 'å®¢äºº' (à¹à¸‚à¸)" },

    { q: "æˆ‘å’Œä»–å…³ç³»å¾ˆå¥½ï¼Œæˆ‘ä»¬æ˜¯å¥½______ã€‚", p: "WÇ’ hÃ© tÄ guÄnxi hÄ›n hÇo, wÇ’men shÃ¬ hÇo ______.", type: 1,
      opts: ["æœ‹å‹ (pÃ©ngyou)", "æ•Œäºº (dÃ­rÃ©n)", "è·¯äºº (lÃ¹rÃ©n)", "ç»ç† (jÄ«nglÇ)"], ans: "æœ‹å‹ (pÃ©ngyou)", t: "à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸à¸±à¸™à¸˜à¹Œà¸—à¸µà¹ˆà¸”à¸µà¹€à¸£à¸µà¸¢à¸à¸§à¹ˆà¸² 'æœ‹å‹' (à¹€à¸à¸·à¹ˆà¸­à¸™)" },

    { q: "åˆ«æ€»æ˜¯é åˆ«äººï¼Œè¿™ä»¶äº‹ä½ è¦______åšã€‚", p: "BiÃ© zÇ’ngshÃ¬ kÃ o biÃ©rÃ©n, zhÃ¨ jiÃ n shÃ¬ nÇ yÃ o ______ zuÃ².", type: 1,
      opts: ["è‡ªå·± (zÃ¬jÇ)", "å¤§å®¶ (dÃ jiÄ)", "æœ‹å‹ (pÃ©ngyou)", "é‚»å±… (lÃ­njÅ«)"], ans: "è‡ªå·± (zÃ¬jÇ)", t: "à¸•à¹‰à¸­à¸‡à¸—à¸³à¸”à¹‰à¸§à¸¢ 'è‡ªå·±' (à¸•à¸™à¹€à¸­à¸‡)" },

    { q: "______éƒ½åˆ°äº†å—ï¼Ÿæˆ‘ä»¬å¼€å§‹å¼€ä¼šå§ã€‚", p: "______ dÅu dÃ o le ma? WÇ’men kÄishÇ kÄihuÃ¬ ba.", type: 1,
      opts: ["å¤§å®¶ (dÃ jiÄ)", "åˆ«äºº (biÃ©rÃ©n)", "è‡ªå·± (zÃ¬jÇ)", "ä¸ªäºº (gÃ¨rÃ©n)"], ans: "å¤§å®¶ (dÃ jiÄ)", t: "à¸–à¸²à¸¡à¸–à¸¶à¸‡à¸„à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹ƒà¸Šà¹‰ 'å¤§å®¶' (à¸—à¸¸à¸à¸„à¸™)" },

    { q: "è¿™æ˜¯æˆ‘çš„å°ç‹—ï¼Œ______å¾ˆå¯çˆ±ã€‚", p: "ZhÃ¨ shÃ¬ wÇ’ de xiÇogÇ’u, ______ hÄ›n kÄ›'Ã i.", type: 1,
      opts: ["å®ƒ (tÄ)", "ä»– (tÄ)", "å¥¹ (tÄ)", "å¤§å®¶ (dÃ jiÄ)"], ans: "å®ƒ (tÄ)", t: "à¸ªà¸±à¸•à¸§à¹Œà¹ƒà¸Šà¹‰à¸ªà¸£à¸£à¸à¸™à¸²à¸¡ 'å®ƒ' (à¸¡à¸±à¸™)" }
];

// æ¸¸æˆçŠ¶æ€
let questions = [];
let currentIdx = 0;
let score = 0;
let userAnswers = new Array(rawQuestions.length).fill(null);

// éšæœºæ‰“ä¹±æ•°ç»„
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// åˆå§‹åŒ–é¢˜ç›®
function initQuestions() {
    questions = rawQuestions.map((item, index) => {
        let options = item.opts.map(opt => ({
            text: opt,
            isCorrect: opt === item.ans
        }));
        options = shuffleArray(options);
        return {
            id: index,
            q: item.q,
            p: item.p,
            type: item.type,
            options: options,
            t: item.t,
            ansText: item.ans 
        };
    });
}

function startQuiz() {
    initQuestions();
    document.getElementById('start-screen').style.display = 'none';
    document.getElementById('quiz-screen').style.display = 'block';
    document.getElementById('footer-nav').style.display = 'flex';
    loadQuestion(0);
}

function loadQuestion(index) {
    currentIdx = index;
    const q = questions[index];
    const savedState = userAnswers[index]; 
    
    document.getElementById('q-progress').innerText = (index + 1) + " / " + questions.length;
    document.getElementById('q-type-label').innerText = q.type === 1 ? "é˜…è¯»é€‰è¯ (Meaning)" : "çœ‹å­—é€‰éŸ³ (Pinyin)";
    document.getElementById('q-text').innerText = (index + 1) + ". " + q.q;
    
    // Type 2ä¸æ˜¾ç¤ºè¾…åŠ©æ‹¼éŸ³ï¼ŒType 1æ˜¾ç¤º
    document.getElementById('q-pinyin').innerText = q.type === 2 ? "" : q.p;
    
    const container = document.getElementById('options-container');
    container.innerHTML = '';
    
    q.options.forEach((opt, optIndex) => {
        const btn = document.createElement('div');
        btn.className = 'option-btn';
        btn.innerText = opt.text;
        
        if (savedState) {
            btn.classList.add('disabled');
            if (opt.isCorrect) btn.classList.add('correct'); 
            if (optIndex === savedState.selectedIndex && !opt.isCorrect) {
                btn.classList.add('wrong'); 
            }
        } else {
            btn.onclick = () => handleAnswer(opt, optIndex, btn);
        }
        
        container.appendChild(btn);
    });
    
    document.getElementById('btn-prev').style.visibility = index === 0 ? 'hidden' : 'visible';
    
    if (savedState) {
        showFeedback(q);
        document.getElementById('btn-next').style.display = 'block';
    } else {
        document.getElementById('feedback-box').style.display = 'none';
        document.getElementById('btn-next').style.display = 'none';
    }
}

function handleAnswer(selectedOpt, selectedIndex, btnElem) {
    const q = questions[currentIdx];
    const isCorrect = selectedOpt.isCorrect;
    if (isCorrect) score++;
    document.getElementById('current-score').innerText = score;
    
    userAnswers[currentIdx] = {
        selectedIndex: selectedIndex,
        isCorrect: isCorrect
    };
    
    const allBtns = document.getElementById('options-container').children;
    for (let i = 0; i < allBtns.length; i++) {
        allBtns[i].classList.add('disabled'); 
        if (q.options[i].isCorrect) {
            allBtns[i].classList.add('correct'); 
        }
    }
    
    if (!isCorrect) {
        btnElem.classList.add('wrong'); 
    }
    
    showFeedback(q);
    document.getElementById('btn-next').style.display = 'block';
    
    setTimeout(() => {
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }, 100);
}

function showFeedback(q) {
    const box = document.getElementById('feedback-box');
    const content = document.getElementById('feedback-content');
    box.style.display = 'block';
    content.innerHTML = `
        <strong>æ­£ç¡®ç­”æ¡ˆ (Correct): ${q.ansText}</strong>
        <div class="thai-expl">ğŸ“ ${q.t}</div>
    `;
}

function nextQuestion() {
    if (currentIdx < questions.length - 1) {
        loadQuestion(currentIdx + 1);
        window.scrollTo(0, 0);
    } else {
        showResult();
    }
}

function prevQuestion() {
    if (currentIdx > 0) {
        loadQuestion(currentIdx - 1);
        window.scrollTo(0, 0);
    }
}

function showResult() {
    document.getElementById('quiz-screen').style.display = 'none';
    document.getElementById('footer-nav').style.display = 'none';
    document.getElementById('result-screen').style.display = 'block';
    document.getElementById('final-score-display').innerText = score;
}
</script>
</body>
</html>